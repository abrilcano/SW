Bootstrap: docker
From: ubuntu:latest

%files
    

%environment
    MPI_DIR=/opt/mpi
    export MPI_DIR
    export SINGULARITY_MPI_DIR=$MPI_DIR
    export SINGULARITYENV_APPEND_PATH=$MPI_DIR/bin
    export SINGULARITYENV_APPEND_LD_LIBRARY_PATH=$MPI_DIR/lib

%post
    echo "Installing required packages..."  
    apt-get update && apt-get install -y build-essential cmake libgtest-dev wget git bash gcc gfortran g++ make file 
    mkdir -p /opt/mpi
    apt-get clean

%runscript
    echo "Executing Matrix-Matrix Multiplication with MPI"
    # Command to run your MPI program
    ls 
    ./build.sh